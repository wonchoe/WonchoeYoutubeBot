# Multi-Platform Media Downloader Bot

Telegram Ğ±Ğ¾Ñ‚ Ğ´Ğ»Ñ Ğ·Ğ°Ğ²Ğ°Ğ½Ñ‚Ğ°Ğ¶ĞµĞ½Ğ½Ñ Ğ¼ĞµĞ´Ñ–Ğ° Ğ· YouTube, Instagram, Facebook Ñ‚Ğ° TikTok.

## ĞŸÑ–Ğ´Ñ‚Ñ€Ğ¸Ğ¼ÑƒĞ²Ğ°Ğ½Ñ– Ğ¿Ğ»Ğ°Ñ‚Ñ„Ğ¾Ñ€Ğ¼Ğ¸

âœ… **YouTube** - audio (MP3 192kbps) + video (360p/480p/720p)  
âœ… **Instagram** - Ğ¿Ğ¾ÑÑ‚Ğ¸, reels, IGTV, Ñ„Ğ¾Ñ‚Ğ¾, ĞºĞ°Ñ€ÑƒÑĞµĞ»ÑŒ Ğ· Ñ„Ğ¾Ñ‚Ğ¾  
âœ… **Facebook** - Ğ²Ñ–Ğ´ĞµĞ¾Ğ¿Ğ¾ÑÑ‚Ğ¸ Ñ‚Ğ° Watch  
âœ… **TikTok** - Ğ²Ñ–Ğ´ĞµĞ¾ (Ğ²ĞºĞ»ÑÑ‡Ğ½Ğ¾ Ğ· ĞºĞ¾Ñ€Ğ¾Ñ‚ĞºĞ¸Ğ¼Ğ¸ Ğ¿Ğ¾ÑĞ¸Ğ»Ğ°Ğ½Ğ½ÑĞ¼Ğ¸)

## ĞÑĞ¾Ğ±Ğ»Ğ¸Ğ²Ğ¾ÑÑ‚Ñ–

- ğŸ¯ ĞĞ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡Ğ½Ğµ Ğ²Ğ¸Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ½Ñ Ğ¿Ğ»Ğ°Ñ‚Ñ„Ğ¾Ñ€Ğ¼Ğ¸
- ğŸ¬ Ğ’Ğ¸Ğ±Ñ–Ñ€ ÑĞºĞ¾ÑÑ‚Ñ– Ğ´Ğ»Ñ YouTube (360p/480p/720p)
- ğŸ“¦ ĞŸÑ–Ğ´Ñ‚Ñ€Ğ¸Ğ¼ĞºĞ° ĞºĞ°Ñ€ÑƒÑĞµĞ»Ñ–Ğ² Instagram
- ğŸ“¤ Custom Telegram Bot API (Ğ¿Ñ–Ğ´Ñ‚Ñ€Ğ¸Ğ¼ĞºĞ° Ñ„Ğ°Ğ¹Ğ»Ñ–Ğ² Ğ´Ğ¾ 2GB)
- ğŸª ĞĞ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡Ğ½Ğµ Ğ¾Ğ½Ğ¾Ğ²Ğ»ĞµĞ½Ğ½Ñ cookies ĞºĞ¾Ğ¶Ğ½Ñ– 4 Ğ³Ğ¾Ğ´Ğ¸Ğ½Ğ¸
- ğŸ§¹ ĞĞ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡Ğ½Ğµ Ğ¾Ñ‡Ğ¸Ñ‰ĞµĞ½Ğ½Ñ Ñ„Ğ°Ğ¹Ğ»Ñ–Ğ² Ğ¿Ñ–ÑĞ»Ñ Ğ½Ğ°Ğ´ÑĞ¸Ğ»Ğ°Ğ½Ğ½Ñ
- â±ï¸ Progress bar Ğ· ETA
- ğŸ”’ Single instance lock

## Cookie Management

Ğ‘Ğ¾Ñ‚ Ğ²Ğ¸ĞºĞ¾Ñ€Ğ¸ÑÑ‚Ğ¾Ğ²ÑƒÑ” Ñ”Ğ´Ğ¸Ğ½Ğ¸Ğ¹ Ñ„Ğ°Ğ¹Ğ» cookies Ğ´Ğ»Ñ Ğ²ÑÑ–Ñ… Ğ¿Ğ»Ğ°Ñ‚Ñ„Ğ¾Ñ€Ğ¼.  
**ğŸ“– Ğ”ĞµÑ‚Ğ°Ğ»ÑŒĞ½Ñ– Ñ–Ğ½ÑÑ‚Ñ€ÑƒĞºÑ†Ñ–Ñ—: [COOKIE_MANAGEMENT.md](COOKIE_MANAGEMENT.md)**

### Ğ¨Ğ²Ğ¸Ğ´ĞºĞ° Ğ½Ğ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞ° cookies

ĞŸĞµÑ€ÑˆĞ¸Ğ¹ Ñ€Ğ°Ğ· (Ğ½Ğ° Ğ»Ğ¾ĞºĞ°Ğ»ÑŒĞ½Ğ¾Ğ¼Ñƒ ÑĞµÑ€Ğ²ĞµÑ€Ñ– Ğ· GUI):
```bash
cd /mnt/laravel/youtube-audio-downloader
source venv/bin/activate
python3 cookie_refresher.py --login
```

Ğ’Ñ–Ğ´ĞºÑ€Ğ¸Ñ”Ñ‚ÑŒÑÑ Ğ±Ñ€Ğ°ÑƒĞ·ĞµÑ€ - Ğ·Ğ°Ğ»Ğ¾Ğ³Ñ–Ğ½ÑŒÑÑ Ğ½Ğ° YouTube, Instagram, Facebook.  
Cookies Ğ°Ğ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡Ğ½Ğ¾ Ğ·Ğ±ĞµÑ€ĞµĞ¶ÑƒÑ‚ÑŒÑÑ Ñ‚Ğ° Ğ±ÑƒĞ´ÑƒÑ‚ÑŒ Ğ¾Ğ½Ğ¾Ğ²Ğ»ÑĞ²Ğ°Ñ‚Ğ¸ÑÑŒ ĞºĞ¾Ğ¶Ğ½Ñ– 4 Ğ³Ğ¾Ğ´Ğ¸Ğ½Ğ¸ Ñ‡ĞµÑ€ĞµĞ· Kubernetes CronJob.

## Deployment

### Kubernetes (Production)

```bash
# Build Ñ‚Ğ° push Docker image
cd /mnt/laravel/youtube-audio-downloader
docker build -t wonchoe/ytdl-bot:latest .
docker push wonchoe/ytdl-bot:latest

# Deploy (Ñ„Ğ°Ğ¹Ğ»Ğ¸ Ğ² wonchoeyt repo)
kubectl apply -f k8s/

# Restart deployment
kubectl rollout restart deployment/ytdl-bot -n wonchoeyoutubebot

# ĞŸĞµÑ€ĞµĞ²Ñ–Ñ€ĞºĞ°
kubectl get pods -n wonchoeyoutubebot
kubectl logs -n wonchoeyoutubebot deployment/ytdl-bot --tail=50
```

### Docker Compose (Local)

```bash
docker-compose up -d
docker-compose logs -f
```

## Ğ¡Ñ‚Ñ€ÑƒĞºÑ‚ÑƒÑ€Ğ° Ğ¿Ñ€Ğ¾ĞµĞºÑ‚Ñƒ

```
/mnt/laravel/youtube-audio-downloader/
â”œâ”€â”€ app.py                    # Main Telegram bot
â”œâ”€â”€ cookie_refresher.py       # Cookie management (login + auto-refresh)
â”œâ”€â”€ entrypoint.sh            # Docker entrypoint
â”œâ”€â”€ Dockerfile               # Container definition
â”œâ”€â”€ requirements.txt         # Python dependencies
â”œâ”€â”€ .env                     # Environment variables (TELEGRAM_BOT_TOKEN)
â”œâ”€â”€ downloaders/             # Platform-specific downloaders
â”‚   â”œâ”€â”€ youtube.py          # YouTube (yt-dlp with cookies)
â”‚   â”œâ”€â”€ instagram.py        # Instagram (yt-dlp + instaloader + gallery-dl)
â”‚   â”œâ”€â”€ facebook.py         # Facebook (yt-dlp with cookies)
â”‚   â””â”€â”€ tiktok.py           # TikTok (yt-dlp)
â”œâ”€â”€ utils/                   # Helpers
â”‚   â”œâ”€â”€ progress.py         # Progress bar
â”‚   â””â”€â”€ telegram_api.py     # Custom Telegram Bot API client
â”œâ”€â”€ COOKIE_MANAGEMENT.md     # Cookie setup guide
â””â”€â”€ README.md               # This file
```

## Troubleshooting

### YouTube: "Sign in to confirm you're not a bot"
â†’ Ğ”Ğ¸Ğ². [COOKIE_MANAGEMENT.md](COOKIE_MANAGEMENT.md)

### Instagram: "401 Unauthorized"
â†’ Ğ—Ğ°Ğ¿ÑƒÑÑ‚Ğ¸ `python3 cookie_refresher.py --login` Ñ‚Ğ° Ğ·Ğ°Ğ»Ğ¾Ğ³Ñ–Ğ½ÑŒÑÑ Ğ½Ğ° Instagram

### Facebook downloads Ğ½Ğµ Ğ¿Ñ€Ğ°Ñ†ÑÑÑ‚ÑŒ
â†’ ĞŸĞµÑ€ĞµĞ²Ñ–Ñ€ cookies: `cat /var/www/ytdl-cookies.txt | grep facebook`

### CronJob Ğ½Ğµ Ğ¾Ğ½Ğ¾Ğ²Ğ»ÑÑ” cookies
```bash
kubectl logs -n wonchoeyoutubebot -l job-name=cookie-refresher --tail=50
```

## Environment Variables

- `TELEGRAM_BOT_TOKEN` - Telegram Bot API token (required)
- Custom Telegram Bot API: `https://tgbot.agro-post.com` (2GB file support)

## License

MIT
- Ğ—Ğ±Ñ–Ğ»ÑŒÑˆĞµĞ½Ñ– timeouts Ğ´Ğ¾ 120 ÑĞµĞºÑƒĞ½Ğ´

## Ğ¡Ñ‚Ñ€ÑƒĞºÑ‚ÑƒÑ€Ğ° Ğ¿Ñ€Ğ¾ĞµĞºÑ‚Ñƒ

```
youtube-audio-downloader/
â”œâ”€â”€ app.py                      # ĞÑĞ½Ğ¾Ğ²Ğ½Ğ¸Ğ¹ Ğ±Ğ¾Ñ‚
â”œâ”€â”€ downloaders/
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ base.py                # Ğ‘Ğ°Ğ·Ğ¾Ğ²Ğ¸Ğ¹ ĞºĞ»Ğ°Ñ
â”‚   â”œâ”€â”€ youtube.py             # YouTube downloader
â”‚   â”œâ”€â”€ instagram.py           # Instagram downloader
â”‚   â”œâ”€â”€ facebook.py            # Facebook downloader
â”‚   â””â”€â”€ tiktok.py              # TikTok downloader
â”œâ”€â”€ utils/
â”‚   â”œâ”€â”€ cleanup.py             # ĞĞ²Ñ‚Ğ¾Ğ¾Ñ‡Ğ¸Ñ‰ĞµĞ½Ğ½Ñ
â”‚   â””â”€â”€ upload.py              # Upload Ğ½Ğ° gofile.io
â”œâ”€â”€ requirements.txt
â”œâ”€â”€ Dockerfile
â””â”€â”€ docker-compose.yml
```

## Ğ›Ñ–Ñ†ĞµĞ½Ğ·Ñ–Ñ

MIT
